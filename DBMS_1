PROGRAM 3 - CRICKET TOURNAMENT

CREATE TABLE TEAM (
    TEAMID INT PRIMARY KEY,
    TEAM_NAME VARCHAR(50),
    CITY VARCHAR(50),
    COACH VARCHAR(50),
    CAPTAIN_PLAYERID INT
);

INSERT INTO TEAM VALUES(1,'WARRIORS','MUMBAI','COACH A',101);
INSERT INTO TEAM VALUES(2,'TITANS','DELHI','COACH B',201);
INSERT INTO TEAM VALUES(3,'RIDERS','CHENNAI','COACH C',301);
INSERT INTO TEAM VALUES(4,'CHALLENGERS','KOLKATA','COACH D',401);
INSERT INTO TEAM VALUES(5,'GLADIATORS','BENGALURU','COACH E',501);


CREATE TABLE PLAYER (
    PLAYERID INT PRIMARY KEY,
    NAME VARCHAR(50),
    AGE INT,
    TEAMID INT,
    FOREIGN KEY (TEAMID) REFERENCES TEAM(TEAMID)
);

INSERT INTO PLAYER VALUES(101,'RAHUL',22,1);
INSERT INTO PLAYER VALUES(102,'AMAN',19,1);
INSERT INTO PLAYER VALUES(103,'VIKAS',25,1);
INSERT INTO PLAYER VALUES(201,'ROHIT',24,2);
INSERT INTO PLAYER VALUES(202,'SURESH',21,2);


CREATE TABLE PLAYER_PHONE (
    PHONEID INT PRIMARY KEY,
    PLAYERID INT,
    PHONE_NO VARCHAR(15),
    FOREIGN KEY (PLAYERID) REFERENCES PLAYER(PLAYERID)
);

CREATE TABLE STADIUM (
    STADIUMID INT PRIMARY KEY,
    STADIUM_NAME VARCHAR(50),
    CITY VARCHAR(50),
    AREA_NAME VARCHAR(50),
    PINCODE VARCHAR(10)
);

INSERT INTO STADIUM VALUES(1,'NATIONAL STADIUM','MUMBAI','ANDHERI','400001');
INSERT INTO STADIUM VALUES(2,'CITY ARENA','DELHI','DWARKA','110001');
INSERT INTO STADIUM VALUES(3,'BEACH GROUND','CHENNAI','MARINA','600001');
INSERT INTO STADIUM VALUES(4,'KOLKATA STADIUM','KOLKATA','HOWRAH','700001');
INSERT INTO STADIUM VALUES(5,'BENGALURU ARENA','BENGALURU','MG ROAD','560001');


CREATE TABLE MATCH_DETAILS (
    MATCHID INT PRIMARY KEY,
    MATCH_DATE DATE,
    MATCH_TIME TIME,
    STADIUMID INT,
    TEAM1_ID INT,
    TEAM2_ID INT,
    WINNER_TEAMID INT,
    MAN_OF_MATCH_PLAYERID INT,
    FOREIGN KEY (STADIUMID) REFERENCES STADIUM(STADIUMID),
    FOREIGN KEY (TEAM1_ID) REFERENCES TEAM(TEAMID),
    FOREIGN KEY (TEAM2_ID) REFERENCES TEAM(TEAMID),
    FOREIGN KEY (WINNER_TEAMID) REFERENCES TEAM(TEAMID),
    FOREIGN KEY (MAN_OF_MATCH_PLAYERID) REFERENCES PLAYER(PLAYERID)
);


INSERT INTO MATCH_DETAILS VALUES(1,'2024-01-10','10:00:00',1,1,2,1,102);
INSERT INTO MATCH_DETAILS VALUES(2,'2024-01-12','14:00:00',1,1,3,1,102);
INSERT INTO MATCH_DETAILS VALUES(3,'2024-01-15','16:00:00',2,2,3,2,202);



QUERIES
1.
SELECT P.NAME, T.TEAM_NAME, P.AGE
FROM PLAYER P
JOIN TEAM T ON P.TEAMID = T.TEAMID
WHERE P.AGE = (SELECT MIN(AGE) FROM PLAYER);

2.
SELECT S.*
FROM STADIUM S
JOIN MATCH_DETAILS M ON S.STADIUMID = M.STADIUMID
GROUP BY S.STADIUMID, S.STADIUM_NAME, S.CITY, S.AREA_NAME, S.PINCODE
HAVING COUNT(M.MATCHID) = (
    SELECT MAX(CNT)
    FROM (
        SELECT COUNT(*) AS CNT
        FROM MATCH_DETAILS
        GROUP BY STADIUMID
    ) X
);


3.
SELECT P.*
FROM PLAYER P
WHERE P.PLAYERID NOT IN (SELECT CAPTAIN_PLAYERID FROM TEAM)
AND P.PLAYERID IN (
    SELECT MAN_OF_MATCH_PLAYERID
    FROM MATCH_DETAILS
    GROUP BY MAN_OF_MATCH_PLAYERID
    HAVING COUNT(*) >= 2
);


4.
SELECT T.*
FROM TEAM T
JOIN MATCH_DETAILS M ON T.TEAMID = M.WINNER_TEAMID
GROUP BY T.TEAMID, T.TEAM_NAME, T.CITY, T.COACH, T.CAPTAIN_PLAYERID
HAVING COUNT(M.MATCHID) = (
    SELECT MAX(CNT)
    FROM (
        SELECT COUNT(*) AS CNT
        FROM MATCH_DETAILS
        GROUP BY WINNER_TEAMID
    ) Y
);

5.
SELECT T.TEAM_NAME
FROM TEAM T
JOIN MATCH_DETAILS M ON T.TEAMID = M.WINNER_TEAMID
GROUP BY T.TEAMID, T.TEAM_NAME
HAVING COUNT(DISTINCT M.STADIUMID) = 1;



