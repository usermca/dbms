PROGRAM 3 - CRICKET TOURNAMENT

CREATE TABLE TEAM (
    TEAMID INT PRIMARY KEY,
    TEAM_NAME VARCHAR(50),
    CITY VARCHAR(50),
    COACH VARCHAR(50),
    CAPTAIN_PLAYERID INT
);

INSERT INTO TEAM VALUES(1,'WARRIORS','MUMBAI','COACH A',101);
INSERT INTO TEAM VALUES(2,'TITANS','DELHI','COACH B',201);
INSERT INTO TEAM VALUES(3,'RIDERS','CHENNAI','COACH C',301);
INSERT INTO TEAM VALUES(4,'CHALLENGERS','KOLKATA','COACH D',401);
INSERT INTO TEAM VALUES(5,'GLADIATORS','BENGALURU','COACH E',501);


CREATE TABLE PLAYER (
    PLAYERID INT PRIMARY KEY,
    NAME VARCHAR(50),
    AGE INT,
    TEAMID INT,
    FOREIGN KEY (TEAMID) REFERENCES TEAM(TEAMID)
);

INSERT INTO PLAYER VALUES(101,'RAHUL',22,1);
INSERT INTO PLAYER VALUES(102,'AMAN',19,1);
INSERT INTO PLAYER VALUES(103,'VIKAS',25,1);
INSERT INTO PLAYER VALUES(201,'ROHIT',24,2);
INSERT INTO PLAYER VALUES(202,'SURESH',21,2);


CREATE TABLE STADIUM (
    STADIUMID INT PRIMARY KEY,
    STADIUM_NAME VARCHAR(50),
    CITY VARCHAR(50),
    AREA_NAME VARCHAR(50),
    PINCODE VARCHAR(10)
);

INSERT INTO STADIUM VALUES(1,'NATIONAL STADIUM','MUMBAI','ANDHERI','400001');
INSERT INTO STADIUM VALUES(2,'CITY ARENA','DELHI','DWARKA','110001');
INSERT INTO STADIUM VALUES(3,'BEACH GROUND','CHENNAI','MARINA','600001');
INSERT INTO STADIUM VALUES(4,'KOLKATA STADIUM','KOLKATA','HOWRAH','700001');
INSERT INTO STADIUM VALUES(5,'BENGALURU ARENA','BENGALURU','MG ROAD','560001');


CREATE TABLE MATCH_DETAILS (
    MATCHID INT PRIMARY KEY,
    MATCH_DATE DATE,
    MATCH_TIME TIME,
    STADIUMID INT,
    TEAM1_ID INT,
    TEAM2_ID INT,
    WINNER_TEAMID INT,
    MAN_OF_MATCH_PLAYERID INT,
    FOREIGN KEY (STADIUMID) REFERENCES STADIUM(STADIUMID),
    FOREIGN KEY (TEAM1_ID) REFERENCES TEAM(TEAMID),
    FOREIGN KEY (TEAM2_ID) REFERENCES TEAM(TEAMID),
    FOREIGN KEY (WINNER_TEAMID) REFERENCES TEAM(TEAMID),
    FOREIGN KEY (MAN_OF_MATCH_PLAYERID) REFERENCES PLAYER(PLAYERID)
);


INSERT INTO MATCH_DETAILS VALUES(1,'2024-01-10','10:00:00',1,1,2,1,102);
INSERT INTO MATCH_DETAILS VALUES(2,'2024-01-12','14:00:00',1,1,3,1,102);
INSERT INTO MATCH_DETAILS VALUES(3,'2024-01-15','16:00:00',2,2,3,2,202);



QUERIES
1.
SELECT P.NAME, T.TEAM_NAME, P.AGE
FROM PLAYER P
JOIN TEAM T ON P.TEAMID = T.TEAMID
WHERE P.AGE = (SELECT MIN(AGE) FROM PLAYER);

2.
SELECT S.*
FROM STADIUM S
JOIN MATCH_DETAILS M ON S.STADIUMID = M.STADIUMID
GROUP BY S.STADIUMID, S.STADIUM_NAME, S.CITY, S.AREA_NAME, S.PINCODE
HAVING COUNT(M.MATCHID) = (
    SELECT MAX(CNT)
    FROM (
        SELECT COUNT(*) AS CNT
        FROM MATCH_DETAILS
        GROUP BY STADIUMID
    ) X
);


3.
SELECT P.*
FROM PLAYER P
WHERE P.PLAYERID NOT IN (SELECT CAPTAIN_PLAYERID FROM TEAM)
AND P.PLAYERID IN (
    SELECT MAN_OF_MATCH_PLAYERID
    FROM MATCH_DETAILS
    GROUP BY MAN_OF_MATCH_PLAYERID
    HAVING COUNT(*) >= 2
);


4.
SELECT T.*
FROM TEAM T
JOIN MATCH_DETAILS M ON T.TEAMID = M.WINNER_TEAMID
GROUP BY T.TEAMID, T.TEAM_NAME, T.CITY, T.COACH, T.CAPTAIN_PLAYERID
HAVING COUNT(M.MATCHID) = (
    SELECT MAX(CNT)
    FROM (
        SELECT COUNT(*) AS CNT
        FROM MATCH_DETAILS
        GROUP BY WINNER_TEAMID
    ) Y
);

5.
SELECT T.TEAM_NAME
FROM TEAM T
JOIN MATCH_DETAILS M ON T.TEAMID = M.WINNER_TEAMID
GROUP BY T.TEAMID, T.TEAM_NAME
HAVING COUNT(DISTINCT M.STADIUMID) = 1;


















PROGRAM 5 



CREATE TABLE Tourist (
    tourist_id INT PRIMARY KEY,
    name VARCHAR(50),
    age INT
);

INSERT INTO Tourist VALUES (1, 'Alice', 30);
INSERT INTO Tourist VALUES (2, 'Bob', 25);
INSERT INTO Tourist VALUES (3, 'Charlie', 28);
INSERT INTO Tourist VALUES (4, 'David', 35);



CREATE TABLE Tourist_Place (
    tourist_place_id INT PRIMARY KEY,
    name VARCHAR(50),
    state_name VARCHAR(50),
    km_from_capital INT,
    history VARCHAR(255)
);

INSERT INTO Tourist_Place VALUES (1, 'Gateway of India', 'Maharashtra', 0, 'Historic monument');
INSERT INTO Tourist_Place VALUES (2, 'Ajanta Caves', 'Maharashtra', 300, 'Ancient caves');
INSERT INTO Tourist_Place VALUES (3, 'Amber Fort', 'Rajasthan', 11, 'Famous fort');
INSERT INTO Tourist_Place VALUES (4, 'Jaipur Palace', 'Rajasthan', 15, 'Royal palace');
INSERT INTO Tourist_Place VALUES (5, 'Hollywood', 'California', 20, 'Movie hub');
INSERT INTO Tourist_Place VALUES (6, 'Yosemite', 'California', 300, 'National park');



CREATE TABLE Visits (
    tourist_id INT,
    tourist_place_id INT,
    visited_date DATE,
    PRIMARY KEY (tourist_id, tourist_place_id, visited_date),
    FOREIGN KEY (tourist_id) REFERENCES Tourist(tourist_id),
    FOREIGN KEY (tourist_place_id) REFERENCES Tourist_Place(tourist_place_id)
);

INSERT INTO Visits VALUES (2, 2, '2026-01-01'); 
INSERT INTO Visits VALUES (2, 4, '2026-01-02'); 
INSERT INTO Visits VALUES (2, 5, '2026-01-03'); 
INSERT INTO Visits VALUES (3, 1, '2026-01-01'); 
INSERT INTO Visits VALUES (3, 2, '2026-01-02'); 
INSERT INTO Visits VALUES (3, 3, '2026-01-03'); 
INSERT INTO Visits VALUES (3, 4, '2026-01-04'); 
INSERT INTO Visits VALUES (3, 5, '2026-01-05'); 
INSERT INTO Visits VALUES (3, 6, '2026-01-06'); 
INSERT INTO Visits VALUES (4, 5, '2026-01-01'); 
INSERT INTO Visits VALUES (4, 6, '2026-01-02'); 


QUERYS

1.

SELECT state_name, COUNT(*) AS total_places
FROM Tourist_Place
GROUP BY state_name
ORDER BY total_places DESC
LIMIT 1;


2.

SELECT tp.name, COUNT(DISTINCT v.tourist_id) AS total_visitors
FROM Tourist_Place tp
JOIN Visits v ON tp.tourist_place_id = v.tourist_place_id
GROUP BY tp.name
ORDER BY total_visitors DESC
LIMIT 1;


3.

SELECT t.name
FROM Tourist t
WHERE NOT EXISTS (
    SELECT 1
    FROM Tourist_Place tp
    WHERE tp.state_name = 'Maharashtra'
      AND tp.tourist_place_id NOT IN (
          SELECT v.tourist_place_id
          FROM Visits v
          WHERE v.tourist_id = t.tourist_id
      )
);


4.

SELECT t.name
FROM Tourist t
WHERE NOT EXISTS (
    SELECT 1
    FROM Tourist_Place tp
    WHERE tp.tourist_place_id NOT IN (
        SELECT v.tourist_place_id
        FROM Visits v
        WHERE v.tourist_id = t.tourist_id
    )
);


5.

SELECT DISTINCT tp.name
FROM Tourist_Place tp
JOIN Visits v ON tp.tourist_place_id = v.tourist_place_id
WHERE v.tourist_id IN (
    SELECT v2.tourist_id
    FROM Visits v2
    JOIN Tourist_Place tp2 ON v2.tourist_place_id = tp2.tourist_place_id
    GROUP BY v2.tourist_id
    HAVING COUNT(DISTINCT tp2.state_name) = (SELECT COUNT(DISTINCT state_name) FROM Tourist_Place)
);
